setwd("D:\\01_study\\001_md\\bioinformation")
survival_file <- read.table('../data/TCGA-CESC.survival.tsv.gz',
header = T, sep = '\t',
quote = '', check.names = F)
survival_file <- survival_file[grep("-01A",survival_file$sample),]
survival_file <- read.table('../data/TCGA-CESC.survival.tsv.gz',
header = T, sep = '\t',
quote = '', check.names = F)
survival_file <- survival_file[grep("-01A",survival_file$sample),]
head(survival_file)
fpkm_file <- read.table('../data/TCGA-CESC.htseq_fpkm.tsv.gz',
header = T, sep = '\t',
quote = '', check.names = F)
fpkm_file <- read.table('../data/TCGA-CESC.star_fpkm.tsv.gz',
header = T, sep = '\t',
quote = '', check.names = F)
head(fpkm_file)
survival_file <- survival_file[survival_file$sample %in% colnames(fpkm_file),]
row.names(fpkm_file) <- fpkm_file$Ensembl_ID
fpkm_file <- fpkm_file[,survival_file$sample]
View(fpkm_file)
survival_file <- read.table('../data/TCGA-CESC.survival.tsv.gz',
header = T, sep = '\t',
quote = '', check.names = F)
survival_file <- survival_file[grep("-01A",survival_file$sample),]
head(survival_file)
survival_file <- survival_file[survival_file$sample %in% colnames(fpkm_file),]
row.names(fpkm_file) <- fpkm_file$Ensembl_ID
fpkm_file <- fpkm_file[,survival_file$sample]
# - 基因ID转换
library(org.Hs.eg.db)
keytypes(org.Hs.eg.db)
head(keys(org.Hs.eg.db,"ENSEMBL"))
View(fpkm_file)
View(fpkm_file)
head(fpkm_file)
fpkm_file <- read.table('../data/TCGA-CESC.star_fpkm.tsv.gz',
header = T, sep = '\t',
quote = '', check.names = F)
head(fpkm_file)
View(fpkm_file)
row.names(fpkm_file) <- fpkm_file$Ensembl_ID
View(fpkm_file)
fpkm_file <- fpkm_file[,survival_file$sample]
View(fpkm_file)
fpkm_file$ENSG_id <- row.names(fpkm_file)
head(fpkm_file$ENSG_id)
head(fpkm_file$ENSG_id)
fpkm_file$ENSG_id <- data.table::tstrsplit(fpkm_file$ENSG_id, "\\.")[[1]]
head(fpkm_file$ENSG_id)
gene_id <- clusterProfiler::bitr(fpkm_file$ENSG_id, OrgDb = org.Hs.eg.db,
fromType="ENSEMBL",toType="SYMBOL")
head(gene_id)
fpkm_file <- merge(gene_id, fpkm_file, by.x="ENSEMBL", by.y="ENSG_id")
View(fpkm_file)
fpkm_data <- aggregate(fpkm_file[-c(1,2)],
by=list(gene=fpkm_file$SYMBOL),
FUN=mean)
View(fpkm_data)
View(fpkm_data)
View(fpkm_file)
fpkm_file[-c(1,2)]
row.names(fpkm_data) <- fpkm_data$gene
fpkm_data <- fpkm_data[-1]
fpkm_data[1:5,1:4]
save(fpkm_data, survival_file, file="../output/TCGA_data.RData")
rm(list=ls())
# load("WGCNA-hubgene.Rdata")
load("../output/TCGA_data.RData")
library(survival)
library(survminer)
library(timeROC)
# 需要安装的包列表
packages <- c("survival", "survminer", "timeROC")
# 使用循环安装
for (pkg in packages) {
if (!require(pkg, quietly = TRUE)) { # 先检查包是否已安装
install.packages(pkg)
}
}
